#    Makefile template for Configure for the MIPS simulator.
#    Written by Cygnus Support.

## COMMON_PRE_CONFIG_FRAG

SIM_OBJS = interp.o
# FIXME: Hack to find syscall.h?  Better support for syscall.h
# is in progress.
SIM_EXTRA_CFLAGS = -I$(srcdir)/../../newlib/libc/sys/idt
SIM_EXTRA_CLEAN = clean-extra

## COMMON_POST_CONFIG_FRAG

interp.o: interp.c engine.c support.h config.h

engine.c: gencode
	./gencode @SIMCONF@ > $@

gencode: gencode.o getopt.o getopt1.o
	$(CC_FOR_BUILD) -o $@ gencode.o getopt.o getopt1.o

gencode.o: $(srcdir)/gencode.c
	$(CC_FOR_BUILD) -c -g -I${srcroot}/include $(srcdir)/gencode.c
getopt.o: $(srcdir)/../../libiberty/getopt.c
	$(CC_FOR_BUILD) -c -g -I${srcroot}/include $(srcdir)/../../libiberty/getopt.c
getopt1.o: $(srcdir)/../../libiberty/getopt1.c
	$(CC_FOR_BUILD) -c -g -I${srcroot}/include $(srcdir)/../../libiberty/getopt1.c

clean-extra:
	rm -f gencode engine.c
